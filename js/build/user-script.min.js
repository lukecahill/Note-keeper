!function(){function e(){$.ajax({method:"POST",url:"includes/user-settings.php",data:{id:userId,action:"get-settings"}}).done(function(e,o){e=$.parseJSON(e);var n=e[0],r=e[1],t=$("#select-tag-color"),s=t.find("option[value={0}]".format(n));s.remove(),t.find("option:eq(0)").before(s),$("#select-tag-color > option:eq(0)").attr("selected",!0),$noteOrder=$("#options-note-order"),s=$noteOrder.find("option[value={0}]".format(r)),s.remove(),$noteOrder.find("option:eq(0)").before(s),$("#options-note-order > option:eq(0)").attr("selected",!0),"true"===e[2]&&$("#search_title").prop("checked",!0),"true"===e[3]&&$("#search_text").prop("checked",!0),"true"===e[4]&&$("#search_mark_done").prop("checked",!0),$("#total_notes").append(e[5]),e[6].reverse(),p.append("<b>Most Recent</b>"),$.each(e[6],function(e,o){p.append("<p>{0}</p>".format(o))}),"dark"===e[7]&&$("#theme_checkbox").prop("checked",!0)}).fail(function(e){console.log("An error occurred",e)})}$("#password-change, #search-div, #order-div, #color-div, #recent-ips-div, #theme-div").hide();var o=!1,n=!1,r=!1,t=!1,s=!1,c=!1,a=$(".password_span"),d=$(".order_dropdown_span"),i=$(".search_dropdown_span"),l=$(".color_dropdown_span"),p=$("#recent-ips-div"),h=$(".recent_ips_span"),u=$(".theme_dropdown_span");String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(o,n){return"undefined"!=typeof e[n]?e[n]:o})}),e(),$("#tag-color-button").on("click",function(){var e=$("#select-tag-color").val();$.ajax({method:"POST",url:"includes/user-settings.php",data:{color:e,id:userId,action:"set-tag-color"}}).done(function(e,o){toastr.success("Tag color updated!")}).fail(function(e){console.log("An error occurred",e)})}),$("#options-order-button").on("click",function(){var e=$("#options-note-order").val();$.ajax({method:"POST",url:"includes/user-settings.php",data:{id:userId,action:"set-note-order",order:e}}).done(function(e,o){toastr.success("Note order has been successfully updated!")}).fail(function(e){console.log("An error occurred",e)})}),$("#options-search-button").on("click",function(){var e=$("#search_title").is(":checked"),o=$("#search_text").is(":checked"),n=$("#search_mark_done").is(":checked");return e===!1&&o===!1?void alert("You must chose to search by either one or both of title and text!"):void $.ajax({method:"POST",url:"includes/user-settings.php",data:{id:userId,action:"set-search-parameters",text:o,title:e,complete:n}}).done(function(e,o){toastr.success("Search settings updated!")}).fail(function(e){console.log("An error occurred",e)})}),$("#change-password-form").on("submit",function(e){$(".validation-error").remove();var o=$("#new-password").val(),n=$("#confirm-password").val(),r=$("#old-password").val();return confirm("Please confirm you wish to change your password.")?""===r?($("#old-password").after('<span class="validation-error">Please enter your old password!</span>'),void e.preventDefault()):""===o.trim()||""===n.trim()?($("#new-password").after('<span class="validation-error">The new or confirmation input is empty!</span>'),void e.preventDefault()):o!==n?($("#confirm-password").after('<span class="validation-error">The confirmation password is different!</span>'),void e.preventDefault()):void 0:void e.preventDefault()}),$("#theme-button").on("click",function(){var e=$("#theme_checkbox").is(":checked"),o="light";e&&(o="dark"),$.ajax({method:"POST",url:"includes/user-settings.php",data:{action:"set-theme",theme:o,id:userId}}).done(function(e,o){toastr.success("Updated theme settings! Please refresh your page.")}).fail(function(e){console.log(e)})}),$("#password-header").on("click",function(){$("#password-change").toggle(),o?(a.addClass("glyphicon-chevron-up"),a.removeClass("glyphicon-chevron-down"),o=!1):(a.addClass("glyphicon-chevron-down"),a.removeClass("glyphicon-chevron-up"),o=!0)}),$("#color-header").on("click",function(){$("#color-div").toggle(),n?(l.addClass("glyphicon-chevron-up"),l.removeClass("glyphicon-chevron-down"),n=!1):(l.addClass("glyphicon-chevron-down"),l.removeClass("glyphicon-chevron-up"),n=!0)}),$("#order-header").on("click",function(){$("#order-div").toggle(),r?(d.addClass("glyphicon-chevron-up"),d.removeClass("glyphicon-chevron-down"),r=!1):(d.addClass("glyphicon-chevron-down"),d.removeClass("glyphicon-chevron-up"),r=!0)}),$("#search-header").on("click",function(){$("#search-div").toggle(),t?(i.addClass("glyphicon-chevron-up"),i.removeClass("glyphicon-chevron-down"),t=!1):(i.addClass("glyphicon-chevron-down"),i.removeClass("glyphicon-chevron-up"),t=!0)}),$("#recent-ips-header").on("click",function(){$("#recent-ips-div").toggle(),s?(h.addClass("glyphicon-chevron-up"),h.removeClass("glyphicon-chevron-down"),s=!1):(h.addClass("glyphicon-chevron-down"),h.removeClass("glyphicon-chevron-up"),s=!0)}),$("#theme-header").on("click",function(){$("#theme-div").toggle(),c?(u.addClass("glyphicon-chevron-up"),u.removeClass("glyphicon-chevron-down"),c=!1):(u.addClass("glyphicon-chevron-down"),u.removeClass("glyphicon-chevron-up"),c=!0)})}();