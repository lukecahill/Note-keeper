!function(){function o(){$.ajax({method:"POST",url:"includes/user-settings.php",data:{id:userId,action:"get-settings"}}).done(function(o,e){o=$.parseJSON(o);var r=o[0],n=o[1],t=$("#select-tag-color"),s=t.find("option[value={0}]".format(r));s.remove(),t.find("option:eq(0)").before(s),$("#select-tag-color > option:eq(0)").attr("selected",!0),$noteOrder=$("#options-note-order"),s=$noteOrder.find("option[value={0}]".format(n)),s.remove(),$noteOrder.find("option:eq(0)").before(s),$("#options-note-order > option:eq(0)").attr("selected",!0),"true"===o[2]&&$("#search_title").prop("checked",!0),"true"===o[3]&&$("#search_text").prop("checked",!0),"true"===o[4]&&$("#search_mark_done").prop("checked",!0),$("#total_notes").append(o[5]),o[6].reverse(),l.append("<b>Most Recent</b>"),$.each(o[6],function(o,e){l.append("<p>{0}</p>".format(e))})}).fail(function(o){console.log("An error occurred",o)})}$("#password-change, #search-div, #order-div, #color-div, #recent-ips-div").hide();var e=!1,r=!1,n=!1,t=!1,s=!1,a=$(".password_span"),c=$(".order_dropdown_span"),d=$(".search_dropdown_span"),i=$(".color_dropdown_span"),l=$("#recent-ips-div"),p=$(".recent_ips_span");String.prototype.format||(String.prototype.format=function(){var o=arguments;return this.replace(/{(\d+)}/g,function(e,r){return"undefined"!=typeof o[r]?o[r]:e})}),o(),$("#tag-color-button").on("click",function(){var o=$("#select-tag-color").val();$.ajax({method:"POST",url:"includes/user-settings.php",data:{color:o,id:userId,action:"set-tag-color"}}).done(function(o,e){toastr.success("Tag color updated!")}).fail(function(o){console.log("An error occurred",o)})}),$("#options-order-button").on("click",function(){var o=$("#options-note-order").val();$.ajax({method:"POST",url:"includes/user-settings.php",data:{id:userId,action:"set-note-order",order:o}}).done(function(o,e){toastr.success("Note order has been successfully updated!")}).fail(function(o){console.log("An error occurred",o)})}),$("#options-search-button").on("click",function(){var o=$("#search_title").is(":checked"),e=$("#search_text").is(":checked"),r=$("#search_mark_done").is(":checked");return o===!1&&e===!1?void alert("You must chose to search by either one or both of title and text!"):void $.ajax({method:"POST",url:"includes/user-settings.php",data:{id:userId,action:"set-search-parameters",text:e,title:o,complete:r}}).done(function(o,e){toastr.success("Search settings updated!")}).fail(function(o){console.log("An error occurred",o)})}),$("#change-password-form").on("submit",function(o){$(".validation-error").remove();var e=$("#new-password").val(),r=$("#confirm-password").val(),n=$("#old-password").val();return confirm("Please confirm you wish to change your password.")?""===n?($("#old-password").after('<span class="validation-error">Please enter your old password!</span>'),void o.preventDefault()):""===e.trim()||""===r.trim()?($("#new-password").after('<span class="validation-error">The new or confirmation input is empty!</span>'),void o.preventDefault()):e!==r?($("#confirm-password").after('<span class="validation-error">The confirmation password is different!</span>'),void o.preventDefault()):void 0:void o.preventDefault()}),$("#password-header").on("click",function(){$("#password-change").toggle(),e?(a.addClass("glyphicon-chevron-up"),a.removeClass("glyphicon-chevron-down"),e=!1):(a.addClass("glyphicon-chevron-down"),a.removeClass("glyphicon-chevron-up"),e=!0)}),$("#color-header").on("click",function(){$("#color-div").toggle(),r?(i.addClass("glyphicon-chevron-up"),i.removeClass("glyphicon-chevron-down"),r=!1):(i.addClass("glyphicon-chevron-down"),i.removeClass("glyphicon-chevron-up"),r=!0)}),$("#order-header").on("click",function(){$("#order-div").toggle(),n?(c.addClass("glyphicon-chevron-up"),c.removeClass("glyphicon-chevron-down"),n=!1):(c.addClass("glyphicon-chevron-down"),c.removeClass("glyphicon-chevron-up"),n=!0)}),$("#search-header").on("click",function(){$("#search-div").toggle(),t?(d.addClass("glyphicon-chevron-up"),d.removeClass("glyphicon-chevron-down"),t=!1):(d.addClass("glyphicon-chevron-down"),d.removeClass("glyphicon-chevron-up"),t=!0)}),$("#recent-ips-header").on("click",function(){$("#recent-ips-div").toggle(),s?(p.addClass("glyphicon-chevron-up"),p.removeClass("glyphicon-chevron-down"),s=!1):(p.addClass("glyphicon-chevron-down"),p.removeClass("glyphicon-chevron-up"),s=!0)})}();