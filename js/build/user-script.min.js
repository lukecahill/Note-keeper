!function(){function o(){$.ajax({method:"POST",url:"includes/user-settings.php",data:{id:userId,action:"get-settings"}}).done(function(o,n){o=JSON.parse(o),e(o)}).fail(function(o){console.log("An error occurred",o)})}function e(o){var e=o[0],n=o[1],r=$("#select-tag-color"),a=r.find("option[value={0}]".format(e));a.remove(),r.find("option:eq(0)").before(a),$("#select-tag-color > option:eq(0)").attr("selected",!0),$noteOrder=$("#options-note-order"),a=$noteOrder.find("option[value={0}]".format(n)),a.remove(),$noteOrder.find("option:eq(0)").before(a),$("#options-note-order > option:eq(0)").attr("selected",!0),"true"===o[2]&&$("#search_title").prop("checked",!0),"true"===o[3]&&$("#search_text").prop("checked",!0),"true"===o[4]&&$("#search_mark_done").prop("checked",!0),$("#total_notes").append(o[5]),o[6].reverse(),g.append("<b>Most Recent</b>"),o[6].forEach(function(o,e){g.append("<p>{0}</p>".format(o))}),"dark"===o[7]&&$("#theme_checkbox").prop("checked",!0),localStorage.setItem("theme",o[7])}function n(o,e){$.ajax({url:"includes/user-settings.php",method:"POST",data:{action:"location",latitude:o,longitude:e,id:userId}}).done(function(o){o=JSON.parse(o),"success"===o&&console.log("Saved")}).error(function(o){console.warn("Could not save location")})}$("#password-change, #search-div, #order-div, #color-div, #recent-ips-div, #theme-div, #maps-div, #share-div").hide();var r=!1,a=!1,t=!1,s=!1,c=!1,d=!1,i=!1,l=!1,h=$(".password_span"),p=$(".order_dropdown_span"),u=$(".search_dropdown_span"),v=$(".color_dropdown_span"),g=$("#recent-ips-div"),m=$(".recent_ips_span"),f=$(".theme_dropdown_span"),w=$(".maps_dropdown_span"),C=$(".share_dropdown_span");if(localStorageTest()&&("light"===localStorage.getItem("theme")?($("html").removeClass("dark-theme"),$(".container-fluid.account-dark").removeClass("account-dark")):"dark"===localStorage.getItem("theme")&&($("html").addClass("dark-theme"),$(".container-fluid.account-dark").addClass("account-dark"))),o(),$("#tag-color-button").on("click",function(){var o=$("#select-tag-color").val();$.ajax({method:"POST",url:"includes/user-settings.php",data:{color:o,id:userId,action:"set-tag-color"}}).done(function(o,e){toastr.success("Tag color updated!")}).fail(function(o){console.log("An error occurred",o)})}),$("#options-order-button").on("click",function(){var o=$("#options-note-order").val();$.ajax({method:"POST",url:"includes/user-settings.php",data:{id:userId,action:"set-note-order",order:o}}).done(function(o,e){toastr.success("Note order has been successfully updated!")}).fail(function(o){console.log("An error occurred",o)})}),$("#options-search-button").on("click",function(){var o=$("#search_title").is(":checked"),e=$("#search_text").is(":checked"),n=$("#search_mark_done").is(":checked");return o===!1&&e===!1?void alert("You must chose to search by either one or both of title and text!"):void $.ajax({method:"POST",url:"includes/user-settings.php",data:{id:userId,action:"set-search-parameters",text:e,title:o,complete:n}}).done(function(o,e){toastr.success("Search settings updated!")}).fail(function(o){console.log("An error occurred",o)})}),$("#change-password-form").on("submit",function(o){$(".validation-error").remove();var e=$("#new-password").val(),n=$("#confirm-password").val(),r=$("#old-password").val();return confirm("Please confirm you wish to change your password.")?""===r?($("#old-password").after('<span class="validation-error">Please enter your old password!</span>'),void o.preventDefault()):""===e.trim()||""===n.trim()?($("#new-password").after('<span class="validation-error">The new or confirmation input is empty!</span>'),void o.preventDefault()):e!==n?($("#confirm-password").after('<span class="validation-error">The confirmation password is different!</span>'),void o.preventDefault()):void 0:void o.preventDefault()}),$("#theme-button").on("click",function(){var o=$("#theme_checkbox").is(":checked"),e="light";o&&(e="dark"),$.ajax({method:"POST",url:"includes/user-settings.php",data:{action:"set-theme",theme:e,id:userId}}).done(function(o,n){o=JSON.parse(o),"success"===o&&(localStorageTest?(localStorage.setItem("theme",e),toastr.info("Updated theme settings! Please refresh your page.")):toastr.info("Please log out and back in for changes to take place"))}).fail(function(o){console.log(o)})}),$("#password-header").on("click",function(){$("#password-change").toggle(),r?(h.addClass("glyphicon-chevron-up"),h.removeClass("glyphicon-chevron-down"),r=!1):(h.addClass("glyphicon-chevron-down"),h.removeClass("glyphicon-chevron-up"),r=!0)}),$("#color-header").on("click",function(){$("#color-div").toggle(),a?(v.addClass("glyphicon-chevron-up"),v.removeClass("glyphicon-chevron-down"),a=!1):(v.addClass("glyphicon-chevron-down"),v.removeClass("glyphicon-chevron-up"),a=!0)}),$("#order-header").on("click",function(){$("#order-div").toggle(),t?(p.addClass("glyphicon-chevron-up"),p.removeClass("glyphicon-chevron-down"),t=!1):(p.addClass("glyphicon-chevron-down"),p.removeClass("glyphicon-chevron-up"),t=!0)}),$("#search-header").on("click",function(){$("#search-div").toggle(),s?(u.addClass("glyphicon-chevron-up"),u.removeClass("glyphicon-chevron-down"),s=!1):(u.addClass("glyphicon-chevron-down"),u.removeClass("glyphicon-chevron-up"),s=!0)}),$("#recent-ips-header").on("click",function(){$("#recent-ips-div").toggle(),c?(m.addClass("glyphicon-chevron-up"),m.removeClass("glyphicon-chevron-down"),c=!1):(m.addClass("glyphicon-chevron-down"),m.removeClass("glyphicon-chevron-up"),c=!0)}),$("#theme-header").on("click",function(){$("#theme-div").toggle(),d?(f.addClass("glyphicon-chevron-up"),f.removeClass("glyphicon-chevron-down"),d=!1):(f.addClass("glyphicon-chevron-down"),f.removeClass("glyphicon-chevron-up"),d=!0)}),$("#maps-header").on("click",function(){$("#maps-div").toggle(),i?(w.addClass("glyphicon-chevron-up"),w.removeClass("glyphicon-chevron-down"),i=!1):(w.addClass("glyphicon-chevron-down"),w.removeClass("glyphicon-chevron-up"),i=!0)}),$("#share-header").on("click",function(){$("#share-div").toggle(),l?(C.addClass("glyphicon-chevron-up"),C.removeClass("glyphicon-chevron-down"),l=!1):(C.addClass("glyphicon-chevron-down"),C.removeClass("glyphicon-chevron-up"),l=!0)}),"geolocation"in navigator){var y=/chrom(e|ium)/.test(navigator.userAgent.toLowerCase());if("https:"!==location.protocol&&y)return console.warn("Geolocation cannot be used on insecure domains using Chrome"),void $("#map_location").html('<p class="error">Geolocation cannot be used on insecure HTTP using Chrome!</p>');navigator.geolocation.getCurrentPosition(function(o){console.log(o.coords.latitude,o.coords.longitude);var e=o.coords.longitude,r=o.coords.latitude;n(r,e)})}else console.warn("Geolocation is not available")}();